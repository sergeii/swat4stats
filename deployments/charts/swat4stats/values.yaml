image:
  repository: ghcr.io/sergeii/swat4stats
  pullPolicy: IfNotPresent
  pullSecrets: ""
  tag: ""

uwsgi:
  port: 9090
  targetPort: 9090
  replicas: 6
  terminationGracePeriodSeconds: 10
  resources:
     limits:
       cpu: 200m
       memory: 300Mi
     requests:
       cpu: 200m
       memory: 300Mi

celery:
  app: swat4stats
  logLevel: INFO
  workers:
    - name: default
      replicas: 4
      concurrency: 1
      queues: [default]
      timeLimit: 300
      maxTasks: 1000

    - name: heavy
      replicas: 2
      concurrency: 1
      queues: [heavy]
      timeLimit: 3600
      maxTasks: 100

    - name: sq
      replicas: 2
      concurrency: 1
      queues: [serverquery]
      timeLimit: 120
      maxTasks: 1000

    - name: cacheback
      concurrency: 2
      replicas: 1
      queues: [cacheback]
      timeLimit: 60
      maxTasks: 10000
  beat:
    replicas: 1

statsdExporter:
  enabled: true
  port: 9117
  targetPort: 9117
  image:
    repository: prom/statsd-exporter
    pullPolicy: IfNotPresent
    pullSecrets: ""
    tag: "v0.28.0"
    sha: "4e7a1f00b9b23ef0c5b4fdbb7f4748bdc218cfdff04acc8033bc5b9f7c15009d"
  resources:
     limits:
       cpu: 50m
       memory: 100Mi
     requests:
       cpu: 50m
       memory: 100Mi

celeryExporter:
  enabled: true
  port: 9808
  targetPort: 9808
  image:
    repository: danihodovic/celery-exporter
    pullPolicy: IfNotPresent
    pullSecrets: ""
    tag: "0.10.8"
    sha: "ed26c17ab276318d2823105e543ddf3763ba2095feef0f1f5c66c667f16f5cc3"
  resources:
     limits:
       cpu: 200m
       memory: 300Mi
     requests:
       cpu: 200m
       memory: 300Mi

staticfiles:
  port: 10080
  targetPort: 80
  image:
    repository: nginx
    pullPolicy: IfNotPresent
    tag: ""
  resources:
     limits:
       cpu: 50m
       memory: 50Mi
     requests:
       cpu: 50m
       memory: 50Mi

service:
  name: swat4stats-core
  type: ClusterIP

envFromSecrets: []
## - name: secret-name
##   optional: true

readinessProbe:
  httpGet:
    path: /info/
    port: uwsgi
    httpHeaders:
      - name: Host
        value: swat4stats.com
  periodSeconds: 10
  initialDelaySeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

livenessProbe:
  httpGet:
    path: /healthcheck/
    port: uwsgi
    httpHeaders:
      - name: Host
        value: swat4stats.com
  periodSeconds: 30
  initialDelaySeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6

sharedEnv:
  SETTINGS_ALLOWED_HOSTS: ".swat4stats.com"
  SETTINGS_LOG_LEVEL: INFO
  SETTINGS_EMAIL_BACKEND_ALIAS: smtp
  SETTINGS_SERVER_EMAIL: django@swat4stats.com
  SETTINGS_DEFAULT_FROM_EMAIL: noreply@swat4stats.com
  SETTINGS_SENTRY_API_SAMPLE_RATE: "0.1"
  SETTINGS_SENTRY_CELERY_SAMPLE_RATE: "0.1"
  SETTINGS_CELERY_BROKER_URL: redis://ha.int.khoroshilov.tech:16379/5
